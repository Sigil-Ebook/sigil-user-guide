<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en">
<head>
  <title>Validation</title>
  <link href="../Styles/styles.css" type="text/css" rel="stylesheet"/>
</head>

<body>
  <h2 id="validation">Validation</h2>

  <p class="h2subheading">— Making sure your EPUB is Error Free —</p>

  <p>In order to be considered a valid EPUB, your ebook must meet the standards defined for EPUBs. This means it must include certain files and information and not contain any errors as defined by the EPUB specification. To help you check if your EPUB is valid you can use the following tools which are available for free as plugins for Sigil.</p>

  <h3 class="sigil_not_in_toc">EPUB Validation With EpubCheck (EPUB2 and EPUB3)</h3>

  <p>For validating all EPUB3’s should run your EPUB through the <a href="https://daisy.org/activities/projects/epubcheck">EpubCheck</a> program. You can use it online or download a local version of the program:</p>
  <ul>
    <li><a href="http://validator.idpf.org">IDPF EPUB Validator</a></li>
  </ul>

  <p>But the best way to use EpubCheck with Sigil is to download the lastest version of the <a href="https://www.mobileread.com/forums/showpost.php?p=2950625">EpubCheck plugin</a> and <a href="manage_plugins.xhtml">install it</a>.</p>

  <p>Development of Epubcheck is done at <a href="https://github.com/w3c/epubcheck">https://github.com/w3c/epubcheck</a>.
  </p>
 
  <p>EpubCheck uses java on your machine and the latest version of the epubcheck.jar to verify your EPUB meets the EPUB specification.</p>

  <p>When EpubCheck installed and used as a plugin, it will return errors and warnings in the Validation window making it easier for the user to navigate to and fix any errors.</p>

  <p>To run epubcheck select Plugins &gt; Validation &gt; epubcheck.</p>

  <p>Once you have run EpubCheck to produce a report, look at each of the issues listed and then edit your document to correct them.</p>

  <div class="image">
    <img alt="Image of the Validation window in action." src="../Images/validation-flightcrew.png"/>
  </div>

  <div class="tip">
    <p class="tiptext">You can double-click on most entries to be taken to the relevant part of the book.</p>
  </div>

  <p>You should validate your document each time you change it to verify there are no more errors.</p>

  <h4 class="sigil_not_in_toc">Common Validation Issues:</h4>

  <div class="tip">
    <p class="tiptext">Note that errors are highlighted in pink, and warnings are highlighted in yellow.</p>
  </div>

  <ul>
    <li><span class="example">This resource is present in the OPF &lt;manifest&gt;, but it's not reachable (it's unused).</span> 

    <ul>
      <li>This warning means you have included the listed file in your EPUB, but you have not used it anywhere in your book. If you intended to use it, you should link to it, otherwise you can delete the file. Try to search all your files or <span class="example">toc.ncx</span> for the filename – you should leave off the pathname when searching, e.g. if the error is in <span class="example">Text/Chapter1.html</span> then just search for <span class="example">Chapter1.html</span></li>
    </ul></li>

    <li><span class="example">This OPS document is reachable but not present in the OPF &lt;manifest or spine&gt;. "Reachable" means that a reference of some kind that points to this resource exists in the EPUB.</span> 

    <ul>
      <li>This error means you have a reference or a link to a file or image in your EPUB, but that file is not included in the EPUB. You need to add the file to the EPUB or correct the name of the file used in your text. You can usually find these by searching for the filename listed in all the HTML files. You may also have to re-generate or update your TOC.</li>
    </ul></li>

    <li><span class="example">ID value 'SOMEIDNAME' is not unique</span> 

    <ul>
      <li>This error means you have an ID named SOMEIDNAME in your EPUB that is defined more than once. Typically these are in headers or footnotes and can be caused by copying and pasting or merging. You can find these by searching all HTML files for the ID name that is listed and changing them so all IDs are different from all other IDs. If the issue is in a heading and you have auto-generated your headings, you can delete the ID and they will be re-generated the next time you create your TOC.</li>
    </ul></li>

    <li><span class="example">attribute 'INVALIDATTRIBUTE' is not declared for element 'SOMEELEMENT'</span> 

    <ul>
      <li>This error means you have an HTML tag named SOMEELEMENT that contains an attribute INVALIDATTRIBUTE, but INVALIDATTRIBUTE is not valid for that tag. For instance <span class="example">&lt;h2 invalidattribute="test"&gt;</span>. This can be caused by typos or by old versions of HTML. You need to search for INVALIDATTRIBUTE in all HTML files and remove, correct, or replace each occurrence.</li>
    </ul></li>

    <li><span class="example">no declaration found for element 'INVALIDELEMENT'</span> 

    <ul>
      <li>This error means you have an HTML tag named INVALIDELEMENT that has not been defined. Typically this is simply because it is invalid and is old HTML syntax that need updating. You need to search for INVALIDELEMENT in all HTML files and remove, correct, or replace these with valid HTML.</li>
    </ul></li>

    <li><span class="example">element 'INVALIDELEMENT' is not allowed for content model '(p|d|h2|h3|h4|h5|h6|div|ul|ol|...'</span> 

    <ul>
      <li>This error means you have an HTML tag named INVALIDELEMENT that is not valid HTML for an EPUB. Typically this is old HTML syntax that needs updating (such as the <span class="example">&lt;center&gt;</span> tag which should be implemented using a style). You need to search for INVALIDELEMENT in all HTML files and remove, correct, or replace each occurrence with valid HTML.</li>
    </ul></li>

    <li><span class="example">value 'SOMENAME' is invalid NCName</span> 

    <ul>
      <li>This error means you have an ID name that is invalid. It probably contains a space or other invalid character. You need to search for SOMENAME and change it.</li>
    </ul></li>
  </ul>

  <h3 class="sigil_not_in_toc" id="tidy">CSS Validation With W3C </h3>

  <p>You can also easily validate your CSS Stylesheet files using the W3C website by selecting the menu item <span class="menuitem">Tools=&gt;Validate Stylesheets With W3C</span>.</p>

  <p>This will send the contents of all of your stylesheets to the W3C service which will produce reports of any issues.</p>

  <p>You can validate individual stylesheets by right-clicking on the stylesheet in the Book Browser and selecting the validate option.</p>

  <div class="tip">
    <p class="tiptext">Validation is done using the W3C Stylesheet Validation Level that was selected in the Preferences menu (<span class="menuitem">Edit=&gt;Preferences=&gt;General Settings=&gt;EPUB2/3 W3C Stylesheet Validation Level</span>).</p>
  </div>

  <h3 class="sigil_not_in_toc" id="tidyx">CSSValidator Plugin</h3>

  <p>There also exists a <a href="https://www.mobileread.com/forums/showthread.php?t=342116">CSS Validator plugin</a> you can use to validate all of your CSS Stylesheet files. Use <span class="menuitem">Plugins=&gt;Manage Plugins</span> to <a href="manage_plugins.xhtml">install it</a>.</p>

  <h3 class="sigil_not_in_toc">EPUB Validation With Devices</h3>

  <p>And in case you missed it: You should always test your EPUB on as many devices or programs as possible.</p>
</body>
</html>